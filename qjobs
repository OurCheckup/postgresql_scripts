-- select * from public."Quaterly_Pivot" where vital = 'heart_rate' and user_id = 394
-- select * from q1

--select Qjobs()
CREATE OR REPLACE FUNCTION Qjobs()
   RETURNS void as $$
   DECLARE "Quaterly" varchar(30); 
   DECLARE "Quaterly_Final" varchar(30); 
   DECLARE "Quaterly_Pivot" varchar(30); 
   DECLARE "u1" varchar(30);
   DECLARE "q1" varchar(30);
Begin   
	--create Quarterly table   form maib table device_details
	
drop table  public."Quaterly";
CREATE TABLE public."Quaterly" AS 
TABLE device_details;
alter table public."Quaterly" add column WHR int;
alter table public."Quaterly" add column HBA1C int;
alter table public."Quaterly" add column HDL_Cholesterol int;
alter table public."Quaterly" add column LDL_Cholesterol int;
alter table public."Quaterly" add column Total_Cholesterol int;
alter table public."Quaterly" add column Triglycerides int;
--create Quaterly_Final table with Quarterwise from Quaterly table
drop table public."Quaterly_Final";
CREATE TABLE public."Quaterly_Final" AS			 
SELECT id,
device_id ,
sys ,
dia ,
pul ,
date date,
body_weight ,
bmi ,
skeleton ,
fat ,
muscle ,
moisture ,
visceral_fat ,
bmr ,
bodyage ,
heart_rate , 
heart_rate_real_time ,
blood_pressure_up ,
blood_pressure_down ,
blood_oxygen ,
blood_oxygen_real_time ,
ecg ,
steps ,
calories_burt ,
spo2 ,
sleep_minutes ,
sleep_hours ,
deep_sleep ,
shallow_sleep,user_id,WHR,HBA1C,HDL_Cholesterol,LDL_Cholesterol,Total_Cholesterol,Triglycerides,extract(quarter from date) as quarter,extract(year from date) as year   from  public."Quaterly";



--create pivot table from the Quaterly_Final
drop table public."Quaterly_Pivot";
create table public."Quaterly_Pivot"(vital,values)
as
select  'sys',sys,quarter,year,user_id,date   from  public."Quaterly_Final"
Union all
select  'dia',dia,quarter,year,user_id,date   from  public."Quaterly_Final"
Union all
select  'pul',pul,quarter,year,user_id,date   from  public."Quaterly_Final"
Union all
select 'body_weight',body_weight,quarter,year,user_id,date   from  public."Quaterly_Final"
Union all
select 'bmi',bmi,quarter,year,user_id,date    from  public."Quaterly_Final"
Union all
select 'fat',fat,quarter,year,user_id,date    from  public."Quaterly_Final"
Union all
select 'muscle',muscle,quarter,year,user_id,date    from  public."Quaterly_Final"
Union all
select 'moisture',moisture,quarter,year,user_id,date    from  public."Quaterly_Final"
Union all
select 'visceral_fat',visceral_fat,quarter,year,user_id,date   from  public."Quaterly_Final"
Union all
select 'bmr',bmr,quarter,year,user_id,date    from  public."Quaterly_Final"
Union all
select 'bodyage',bodyage,quarter,year,user_id,date    from  public."Quaterly_Final"
Union all
select 'heart_rate',heart_rate,quarter,year,user_id,date    from  public."Quaterly_Final"
Union all
select 'heart_rate_real_time',heart_rate_real_time,quarter,year,user_id,date    from  public."Quaterly_Final"
Union all
select 'blood_oxygen',blood_oxygen,quarter,year,user_id,date    from  public."Quaterly_Final"
Union all
select 'blood_oxygen_real_time',blood_oxygen_real_time,quarter,year,user_id,date    from  public."Quaterly_Final"
Union all
select 'ecg',ecg,quarter,year,user_id,date    from  public."Quaterly_Final"
Union all
select 'steps',steps,quarter,year,user_id,date    from  public."Quaterly_Final"
Union all
select 'spo2',spo2,quarter,year,user_id,date    from  public."Quaterly_Final"
Union all
select 'sleep_minutes',sleep_minutes,quarter,year,user_id,date    from  public."Quaterly_Final"
Union all
select 'sleep_hours',sleep_hours,quarter,year,user_id,date    from  public."Quaterly_Final"
Union all
select 'deep_sleep',deep_sleep,quarter,year,user_id,date    from  public."Quaterly_Final"
Union all
select 'shallow_sleep',shallow_sleep,quarter,year,user_id,date    from  public."Quaterly_Final"
Union all
select 'WHR',WHR,quarter,year,user_id,date    from  public."Quaterly_Final"
Union all
select 'HBA1C',HBA1C,quarter,year,user_id,date    from  public."Quaterly_Final"
Union all
select 'HDL_Cholesterol',HDL_Cholesterol,quarter,year,user_id,date    from  public."Quaterly_Final"
Union all
select 'LDL_Cholesterol',LDL_Cholesterol,quarter,year,user_id,date    from  public."Quaterly_Final"
Union all
select 'Total_Cholesterol',Total_Cholesterol,quarter,year,user_id,date    from  public."Quaterly_Final"
Union all
select 'Triglycerides',Triglycerides,quarter,year,user_id,date   from  public."Quaterly_Final";

alter table public."Quaterly_Pivot" add column Initial Decimal(10,2);
alter table public."Quaterly_Pivot" add column Target Decimal(10,2);
alter table public."Quaterly_Pivot" add column Achieved Decimal(10,2);
alter table public."Quaterly_Pivot" add column Performance Decimal(10,2);
alter table public."Quaterly_Pivot" add column Normal_count Decimal(10,2);
alter table public."Quaterly_Pivot" add column total_count Decimal(10,2);
alter table public."Quaterly_Pivot" add column target_new Decimal(10,2);
update public."Quaterly_Pivot" 
set initial=0,achieved=0,normal_count=0,total_count=0 where quarter=1;
update public."Quaterly_Pivot" 
set initial=0,achieved=0,normal_count=0,total_count=0 where quarter=2;
update public."Quaterly_Pivot" 
set initial=0,achieved=0,normal_count=0,total_count=0 where quarter=3;
update public."Quaterly_Pivot" 
set initial=0,achieved=0,normal_count=0,total_count=0 where quarter=4;



DECLARE loop1 integer :=1;
   DECLARE count1 integer;
   DECLARE userid integer;
begin
 
select count (*) into count1 from u2 ;
drop table u2;
create table u2 (id int GENERATED ALWAYS AS IDENTITY,user_id int);
insert into u2 (user_id)
select distinct user_id  from public."Quaterly_Pivot"; 
while (loop1<=(count1)) LOOP
select user_id into userid from u2 where id=loop1;
 update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='sys' and quarter=1  and user_id = userid group by user_id,vital),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='sys' and quarter=1 and user_id = userid   and values >=60 and values<=90 group by user_id ,vital) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='sys' and quarter=1 and  user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='sys' and quarter=1 and  user_id = userid and values >=60 and values<=90   group by user_id,vital,user_id,date order by date desc limit 1)	where Vital='sys' and quarter=1 and user_id=14  ; 
						
update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='dia' and quarter=1 and user_id = userid group by user_id,vital),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='dia' and quarter=1 and values >=60 and values<=90 and  user_id = userid group by user_id,vital   ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='dia' and quarter=1 and user_id = userid group by user_id,vital   ),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='dia' and quarter=1 and values >=60 and values<=90 and user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='dia' and quarter=1 and user_id = userid     ; 
						
update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot" 
				   where vital='pul' and quarter=1 and  user_id = userid group by user_id,vital  ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='pul' and quarter=1 and values >=60 and values<=90 and user_id = userid  group by user_id,vital   ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='pul' and quarter=1 and user_id = userid group by user_id,vital   ),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='pul' and quarter=1 and values >=60 and values<=90 and user_id = userid   group by user_id,vital,date order by date desc limit 1)	
where Vital='pul' and quarter=1 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='body_weight' and quarter=1 and  user_id = userid group by user_id,vital  ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='body_weight' and quarter=1 and values >=60 and values<=90 and user_id = userid  group by user_id,vital   ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='body_weight' and quarter=1 and   user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='body_weight' and quarter=1 and values >=60 and values<=90 and  user_id = userid  group by user_id,vital,date order by date desc limit 1)	
where Vital='body_weight' and quarter=1 and user_id = userid    ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='bmi' and quarter=1 and  user_id = userid group by user_id,vital  ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='bmi' and quarter=1 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='bmi' and quarter=1 and user_id = userid group by user_id,vital    ),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='bmi' and quarter=1 and values >=60 and values<=90  and  user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='bmi' and quarter=1  and user_id = userid     ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='skeleton' and quarter=1 and  user_id = userid group by user_id,vital  ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='skeleton' and quarter=1 and values >=60 and values<=90 and user_id = userid group by user_id,vital   ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='skeleton' and quarter=1 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='skeleton' and quarter=1 and values >=60 and values<=90 and user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='skeleton' and quarter=1 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='fat' and quarter=1 and user_id = userid group by user_id,vital   ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='fat' and quarter=1 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='fat' and quarter=1 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='fat' and quarter=1 and values >=60 and values<=90 and user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='fat' and quarter=1 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='muscle' and quarter=1 and  user_id = userid group by user_id,vital  ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='muscle' and quarter=1 and values >=60 and values<=90 and user_id = userid group by user_id,vital   ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='muscle' and quarter=1 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='muscle' and quarter=1 and values >=60 and values<=90 and user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='muscle' and quarter=1 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='moisture' and quarter=1 and user_id = userid    group by user_id,vital ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='moisture' and quarter=1 and values >=60 and values<=90 and user_id = userid group by user_id,vital   ),
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='moisture' and quarter=1 and user_id = userid group by user_id,vital    ),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='moisture' and quarter=1 and values >=60 and values<=90  and user_id = userid       group by user_id,vital,date order by date desc limit 1)	
where Vital='moisture' and quarter=1  and user_id = userid  ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='visceral_fat' and quarter=1 and user_id = userid group by user_id,vital    ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='visceral_fat' and quarter=1 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='visceral_fat' and quarter=1and user_id = userid     group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='visceral_fat' and quarter=1 and values >=60 and values<=90 and  user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='visceral_fat' and quarter=1 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='bmr' and quarter=1 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='bmr' and quarter=1 and values >=60 and values<=90  and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='bmr' and quarter=1and user_id = userid     group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='bmr' and quarter=1 and values >=60 and values<=90 
and user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='bmr' and quarter=1 and user_id = userid ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='bodyage' and quarter=1 and user_id = userid group by user_id,vital    ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='bodyage' and quarter=1 and values >=60 and values<=90 and  user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='bodyage' and quarter=1 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='bodyage' and quarter=1 and values >=60 and values<=90 and user_id = userid     group by user_id,vital,date order by date desc limit 1)	
where Vital='bodyage' and quarter=1 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot" 
				   where vital='heart_rate ' and quarter=1 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"
				  where vital='heart_rate ' and quarter=1 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"
							where vital='heart_rate ' and quarter=1  and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where 
							Vital='heart_rate ' and quarter=1 and values >=60 and values<=90 and user_id = userid      group by user_id,vital,date order by date desc limit 1)	
where Vital='heart_rate ' and quarter=1 and user_id = userid    ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='heart_rate_real_time ' and quarter=1 and user_id = userid group by user_id,vital    ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='heart_rate_real_time ' and quarter=1 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='heart_rate_real_time ' and quarter=1 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='heart_rate_real_time ' and quarter=1 and values >=60 and values<=90 and user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='heart_rate_real_time ' and quarter=1 and user_id = userid     ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='blood_pressure_up ' and quarter=1 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='blood_pressure_up ' and quarter=1 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='blood_pressure_up ' and quarter=1 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='blood_pressure_up ' and quarter=1 and values >=60 and values<=90 and  user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='blood_pressure_up ' and quarter=1 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='blood_pressure_down ' and quarter=1 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='blood_pressure_down ' and quarter=1 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='blood_pressure_down ' and quarter=1 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='blood_pressure_down ' and quarter=1 and values >=60 and values<=90 and user_id = userid       group by user_id,vital,date order by date desc limit 1)	
where Vital='blood_pressure_down ' and quarter=1  and user_id = userid     ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='blood_oxygen ' and quarter=1 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='blood_oxygen ' and quarter=1 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='blood_oxygen ' and quarter=1 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='blood_oxygen ' and quarter=1 and values >=60 and values<=90 and user_id = userid       group by user_id,vital,date order by date desc limit 1)	
where Vital='blood_oxygen ' and quarter=1 and user_id = userid    ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='blood_oxygen_real_time ' and quarter=1 and user_id = userid group by user_id,vital    ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='blood_oxygen_real_time ' and quarter=1 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='blood_oxygen_real_time ' and quarter=1 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='blood_oxygen_real_time ' and quarter=1 and values >=60 and values<=90 and user_id = userid      group by user_id,vital,date order by date desc limit 1)	
where Vital='blood_oxygen_real_time ' and quarter=1 and user_id = userid     ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='ecg' and quarter=1 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='ecg' and quarter=1 and values >=60 and values<=90 and  user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='ecg' and quarter=1 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='ecg' and quarter=1 and values >=60 and values<=90 and user_id = userid      group by user_id,vital,date order by date desc limit 1)	
where Vital='ecg' and quarter=1 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='steps' and quarter=1 and user_id = userid group by user_id,vital    ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='steps' and quarter=1 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='steps' and quarter=1 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='steps' and quarter=1 and values >=60 and values<=90 and user_id = userid       group by user_id,vital,date order by date desc limit 1)	
where Vital='steps' and quarter=1 and user_id = userid ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='spo2' and quarter=1 and user_id = userid group by user_id,vital    ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='spo2' and quarter=1 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='spo2' and quarter=1 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='spo2' and quarter=1 and values >=60 and values<=90 and user_id = userid      group by user_id,vital,date order by date desc limit 1)	
where Vital='spo2' and quarter=1 and user_id = userid     ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='sleep_minutes ' and quarter=1 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='sleep_minutes ' and quarter=1 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='sleep_minutes ' and quarter=1 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='sleep_minutes ' and quarter=1 and values >=60 and values<=90 and user_id = userid        group by user_id,vital,date order by date desc limit 1)	
where Vital='sleep_minutes ' and quarter=1 and user_id = userid ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='sleep_hours ' and quarter=1 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='sleep_hours ' and quarter=1 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='sleep_hours ' and quarter=1 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='sleep_hours ' and quarter=1 and values >=60 and values<=90  and user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='sleep_hours ' and quarter=1 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='deep_sleep ' and quarter=1 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='deep_sleep ' and quarter=1 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='deep_sleep ' and quarter=1 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='deep_sleep ' and quarter=1 and values >=60 and values<=90 and user_id = userid       group by user_id,vital,date order by date desc limit 1)	
where Vital='deep_sleep ' and quarter=1 and user_id = userid    ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='shallow_sleep' and quarter=1 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='shallow_sleep' and quarter=1 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='shallow_sleep' and quarter=1 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='shallow_sleep' and quarter=1 and values >=60 and values<=90 and  user_id = userid      group by user_id,vital,date order by date desc limit 1)	
where Vital='shallow_sleep' and quarter=1 and user_id = userid; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='WHR' and quarter=1 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='WHR' and quarter=1 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='WHR' and quarter=1 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='WHR' and quarter=1 and values >=60 and values<=90 and user_id = userid     group by user_id,vital,date order by date desc limit 1)	
where Vital='WHR' and quarter=1 and user_id = userid    ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='HBA1C' and quarter=1 and user_id = userid group by user_id,vital    ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='HBA1C' and quarter=1 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='HBA1C' and quarter=1  and user_id = userid group by user_id,vital    ),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='HBA1C' and quarter=1 and values >=60 and values<=90 and user_id = userid     group by user_id,vital,date order by date desc limit 1)	
where Vital='HBA1C' and quarter=1 and user_id = userid      ;

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='HDL_Cholesterol' and quarter=1 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='HDL_Cholesterol' and quarter=1 and values >=60 and values<=90 and  user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='HDL_Cholesterol' and quarter=1 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='HDL_Cholesterol' and quarter=1 and values >=60 and values<=90 and user_id = userid       group by user_id,vital,date order by date desc limit 1)	
where Vital='HDL_Cholesterol' and quarter=1 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='LDL_Cholesterol' and quarter=1 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='LDL_Cholesterol' and quarter=1 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='LDL_Cholesterol' and quarter=1 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='LDL_Cholesterol' and quarter=1 and values >=60 and values<=90 and user_id = userid       group by user_id,vital,date order by date desc limit 1)	
where Vital='LDL_Cholesterol' and quarter=1 and user_id = userid     ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='Total_Cholesterol' and quarter=1 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='Total_Cholesterol' and quarter=1 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='Total_Cholesterol' and quarter=1 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='Total_Cholesterol' and quarter=1 and values >=60 and values<=90 and user_id = userid       group by user_id,vital,date order by date desc limit 1)	
where Vital='Total_Cholesterol' and quarter=1 and user_id = userid ; 


update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='Triglycerides' and quarter=1 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='Triglycerides' and quarter=1 and values >=60 and values<=90 and  user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='Triglycerides' and quarter=1 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='Triglycerides' and quarter=1 and values >=60 and values<=90 and user_id = userid        group by user_id,vital,date order by date desc limit 1)	
where Vital='Triglycerides' and quarter=1  and user_id = userid    ;
						update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='sys' and quarter=2  and user_id = userid group by user_id,vital),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='sys' and quarter=2 and user_id = userid   and values >=60 and values<=90 group by user_id ,vital) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='sys' and quarter=2 and  user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='sys' and quarter=2 and  user_id = userid and values >=60 and values<=90   group by user_id,vital,user_id,date order by date desc limit 1)	where Vital='sys' and quarter=2 and user_id=14  ; 
						
update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='dia' and quarter=2 and user_id = userid group by user_id,vital),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='dia' and quarter=2 and values >=60 and values<=90 and  user_id = userid group by user_id,vital   ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='dia' and quarter=2 and user_id = userid group by user_id,vital   ),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='dia' and quarter=2 and values >=60 and values<=90 and user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='dia' and quarter=2 and user_id = userid     ; 
						
update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot" 
				   where vital='pul' and quarter=2 and  user_id = userid group by user_id,vital  ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='pul' and quarter=2 and values >=60 and values<=90 and user_id = userid  group by user_id,vital   ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='pul' and quarter=2 and user_id = userid group by user_id,vital   ),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='pul' and quarter=2 and values >=60 and values<=90 and user_id = userid   group by user_id,vital,date order by date desc limit 1)	
where Vital='pul' and quarter=2 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='body_weight' and quarter=2 and  user_id = userid group by user_id,vital  ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='body_weight' and quarter=2 and values >=60 and values<=90 and user_id = userid  group by user_id,vital   ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='body_weight' and quarter=2 and   user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='body_weight' and quarter=2 and values >=60 and values<=90 and  user_id = userid  group by user_id,vital,date order by date desc limit 1)	
where Vital='body_weight' and quarter=2 and user_id = userid    ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='bmi' and quarter=2 and  user_id = userid group by user_id,vital  ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='bmi' and quarter=2 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='bmi' and quarter=2 and user_id = userid group by user_id,vital    ),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='bmi' and quarter=2 and values >=60 and values<=90  and  user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='bmi' and quarter=2  and user_id = userid     ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='skeleton' and quarter=2 and  user_id = userid group by user_id,vital  ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='skeleton' and quarter=2 and values >=60 and values<=90 and user_id = userid group by user_id,vital   ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='skeleton' and quarter=2 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='skeleton' and quarter=2 and values >=60 and values<=90 and user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='skeleton' and quarter=2 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='fat' and quarter=2 and user_id = userid group by user_id,vital   ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='fat' and quarter=2 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='fat' and quarter=2 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='fat' and quarter=2 and values >=60 and values<=90 and user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='fat' and quarter=2 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='muscle' and quarter=2 and  user_id = userid group by user_id,vital  ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='muscle' and quarter=2 and values >=60 and values<=90 and user_id = userid group by user_id,vital   ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='muscle' and quarter=2 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='muscle' and quarter=2 and values >=60 and values<=90 and user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='muscle' and quarter=2 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='moisture' and quarter=2 and user_id = userid    group by user_id,vital ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='moisture' and quarter=2 and values >=60 and values<=90 and user_id = userid group by user_id,vital   ),
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='moisture' and quarter=2 and user_id = userid group by user_id,vital    ),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='moisture' and quarter=2 and values >=60 and values<=90  and user_id = userid       group by user_id,vital,date order by date desc limit 1)	
where Vital='moisture' and quarter=2  and user_id = userid  ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='visceral_fat' and quarter=2 and user_id = userid group by user_id,vital    ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='visceral_fat' and quarter=2 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='visceral_fat' and quarter=1and user_id = userid     group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='visceral_fat' and quarter=2 and values >=60 and values<=90 and  user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='visceral_fat' and quarter=2 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='bmr' and quarter=2 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='bmr' and quarter=2 and values >=60 and values<=90  and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='bmr' and quarter=1and user_id = userid     group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='bmr' and quarter=2 and values >=60 and values<=90 
and user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='bmr' and quarter=2 and user_id = userid ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='bodyage' and quarter=2 and user_id = userid group by user_id,vital    ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='bodyage' and quarter=2 and values >=60 and values<=90 and  user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='bodyage' and quarter=2 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='bodyage' and quarter=2 and values >=60 and values<=90 and user_id = userid     group by user_id,vital,date order by date desc limit 1)	
where Vital='bodyage' and quarter=2 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot" 
				   where vital='heart_rate ' and quarter=2 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"
				  where vital='heart_rate ' and quarter=2 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"
							where vital='heart_rate ' and quarter=2  and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where 
							Vital='heart_rate ' and quarter=2 and values >=60 and values<=90 and user_id = userid      group by user_id,vital,date order by date desc limit 1)	
where Vital='heart_rate ' and quarter=2 and user_id = userid    ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='heart_rate_real_time ' and quarter=2 and user_id = userid group by user_id,vital    ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='heart_rate_real_time ' and quarter=2 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='heart_rate_real_time ' and quarter=2 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='heart_rate_real_time ' and quarter=2 and values >=60 and values<=90 and user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='heart_rate_real_time ' and quarter=2 and user_id = userid     ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='blood_pressure_up ' and quarter=2 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='blood_pressure_up ' and quarter=2 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='blood_pressure_up ' and quarter=2 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='blood_pressure_up ' and quarter=2 and values >=60 and values<=90 and  user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='blood_pressure_up ' and quarter=2 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='blood_pressure_down ' and quarter=2 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='blood_pressure_down ' and quarter=2 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='blood_pressure_down ' and quarter=2 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='blood_pressure_down ' and quarter=2 and values >=60 and values<=90 and user_id = userid       group by user_id,vital,date order by date desc limit 1)	
where Vital='blood_pressure_down ' and quarter=2  and user_id = userid     ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='blood_oxygen ' and quarter=2 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='blood_oxygen ' and quarter=2 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='blood_oxygen ' and quarter=2 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='blood_oxygen ' and quarter=2 and values >=60 and values<=90 and user_id = userid       group by user_id,vital,date order by date desc limit 1)	
where Vital='blood_oxygen ' and quarter=2 and user_id = userid    ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='blood_oxygen_real_time ' and quarter=2 and user_id = userid group by user_id,vital    ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='blood_oxygen_real_time ' and quarter=2 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='blood_oxygen_real_time ' and quarter=2 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='blood_oxygen_real_time ' and quarter=2 and values >=60 and values<=90 and user_id = userid      group by user_id,vital,date order by date desc limit 1)	
where Vital='blood_oxygen_real_time ' and quarter=2 and user_id = userid     ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='ecg' and quarter=2 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='ecg' and quarter=2 and values >=60 and values<=90 and  user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='ecg' and quarter=2 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='ecg' and quarter=2 and values >=60 and values<=90 and user_id = userid      group by user_id,vital,date order by date desc limit 1)	
where Vital='ecg' and quarter=2 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='steps' and quarter=2 and user_id = userid group by user_id,vital    ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='steps' and quarter=2 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='steps' and quarter=2 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='steps' and quarter=2 and values >=60 and values<=90 and user_id = userid       group by user_id,vital,date order by date desc limit 1)	
where Vital='steps' and quarter=2 and user_id = userid ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='spo2' and quarter=2 and user_id = userid group by user_id,vital    ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='spo2' and quarter=2 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='spo2' and quarter=2 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='spo2' and quarter=2 and values >=60 and values<=90 and user_id = userid      group by user_id,vital,date order by date desc limit 1)	
where Vital='spo2' and quarter=2 and user_id = userid     ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='sleep_minutes ' and quarter=2 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='sleep_minutes ' and quarter=2 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='sleep_minutes ' and quarter=2 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='sleep_minutes ' and quarter=2 and values >=60 and values<=90 and user_id = userid        group by user_id,vital,date order by date desc limit 1)	
where Vital='sleep_minutes ' and quarter=2 and user_id = userid ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='sleep_hours ' and quarter=2 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='sleep_hours ' and quarter=2 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='sleep_hours ' and quarter=2 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='sleep_hours ' and quarter=2 and values >=60 and values<=90  and user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='sleep_hours ' and quarter=2 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='deep_sleep ' and quarter=2 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='deep_sleep ' and quarter=2 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='deep_sleep ' and quarter=2 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='deep_sleep ' and quarter=2 and values >=60 and values<=90 and user_id = userid       group by user_id,vital,date order by date desc limit 1)	
where Vital='deep_sleep ' and quarter=2 and user_id = userid    ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='shallow_sleep' and quarter=2 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='shallow_sleep' and quarter=2 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='shallow_sleep' and quarter=2 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='shallow_sleep' and quarter=2 and values >=60 and values<=90 and  user_id = userid      group by user_id,vital,date order by date desc limit 1)	
where Vital='shallow_sleep' and quarter=2 and user_id = userid; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='WHR' and quarter=2 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='WHR' and quarter=2 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='WHR' and quarter=2 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='WHR' and quarter=2 and values >=60 and values<=90 and user_id = userid     group by user_id,vital,date order by date desc limit 1)	
where Vital='WHR' and quarter=2 and user_id = userid    ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='HBA1C' and quarter=2 and user_id = userid group by user_id,vital    ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='HBA1C' and quarter=2 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='HBA1C' and quarter=2  and user_id = userid group by user_id,vital    ),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='HBA1C' and quarter=2 and values >=60 and values<=90 and user_id = userid     group by user_id,vital,date order by date desc limit 1)	
where Vital='HBA1C' and quarter=2 and user_id = userid      ;

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='HDL_Cholesterol' and quarter=2 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='HDL_Cholesterol' and quarter=2 and values >=60 and values<=90 and  user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='HDL_Cholesterol' and quarter=2 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='HDL_Cholesterol' and quarter=2 and values >=60 and values<=90 and user_id = userid       group by user_id,vital,date order by date desc limit 1)	
where Vital='HDL_Cholesterol' and quarter=2 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='LDL_Cholesterol' and quarter=2 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='LDL_Cholesterol' and quarter=2 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='LDL_Cholesterol' and quarter=2 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='LDL_Cholesterol' and quarter=2 and values >=60 and values<=90 and user_id = userid       group by user_id,vital,date order by date desc limit 1)	
where Vital='LDL_Cholesterol' and quarter=2 and user_id = userid     ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='Total_Cholesterol' and quarter=2 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='Total_Cholesterol' and quarter=2 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='Total_Cholesterol' and quarter=2 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='Total_Cholesterol' and quarter=2 and values >=60 and values<=90 and user_id = userid       group by user_id,vital,date order by date desc limit 1)	
where Vital='Total_Cholesterol' and quarter=2 and user_id = userid ; 


update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='Triglycerides' and quarter=2 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='Triglycerides' and quarter=2 and values >=60 and values<=90 and  user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='Triglycerides' and quarter=2 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='Triglycerides' and quarter=2 and values >=60 and values<=90 and user_id = userid        group by user_id,vital,date order by date desc limit 1)	
where Vital='Triglycerides' and quarter=2  and user_id = userid    ; 		
update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='sys' and quarter=3  and user_id = userid group by user_id,vital),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='sys' and quarter=3 and user_id = userid   and values >=60 and values<=90 group by user_id ,vital) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='sys' and quarter=3 and  user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='sys' and quarter=3 and  user_id = userid and values >=60 and values<=90   group by user_id,vital,user_id,date order by date desc limit 1)	where Vital='sys' and quarter=3 and user_id=14  ; 
						
update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='dia' and quarter=3 and user_id = userid group by user_id,vital),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='dia' and quarter=3 and values >=60 and values<=90 and  user_id = userid group by user_id,vital   ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='dia' and quarter=3 and user_id = userid group by user_id,vital   ),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='dia' and quarter=3 and values >=60 and values<=90 and user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='dia' and quarter=3 and user_id = userid     ; 
						
update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot" 
				   where vital='pul' and quarter=3 and  user_id = userid group by user_id,vital  ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='pul' and quarter=3 and values >=60 and values<=90 and user_id = userid  group by user_id,vital   ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='pul' and quarter=3 and user_id = userid group by user_id,vital   ),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='pul' and quarter=3 and values >=60 and values<=90 and user_id = userid   group by user_id,vital,date order by date desc limit 1)	
where Vital='pul' and quarter=3 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='body_weight' and quarter=3 and  user_id = userid group by user_id,vital  ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='body_weight' and quarter=3 and values >=60 and values<=90 and user_id = userid  group by user_id,vital   ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='body_weight' and quarter=3 and   user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='body_weight' and quarter=3 and values >=60 and values<=90 and  user_id = userid  group by user_id,vital,date order by date desc limit 1)	
where Vital='body_weight' and quarter=3 and user_id = userid    ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='bmi' and quarter=3 and  user_id = userid group by user_id,vital  ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='bmi' and quarter=3 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='bmi' and quarter=3 and user_id = userid group by user_id,vital    ),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='bmi' and quarter=3 and values >=60 and values<=90  and  user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='bmi' and quarter=3  and user_id = userid     ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='skeleton' and quarter=3 and  user_id = userid group by user_id,vital  ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='skeleton' and quarter=3 and values >=60 and values<=90 and user_id = userid group by user_id,vital   ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='skeleton' and quarter=3 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='skeleton' and quarter=3 and values >=60 and values<=90 and user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='skeleton' and quarter=3 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='fat' and quarter=3 and user_id = userid group by user_id,vital   ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='fat' and quarter=3 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='fat' and quarter=3 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='fat' and quarter=3 and values >=60 and values<=90 and user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='fat' and quarter=3 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='muscle' and quarter=3 and  user_id = userid group by user_id,vital  ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='muscle' and quarter=3 and values >=60 and values<=90 and user_id = userid group by user_id,vital   ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='muscle' and quarter=3 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='muscle' and quarter=3 and values >=60 and values<=90 and user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='muscle' and quarter=3 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='moisture' and quarter=3 and user_id = userid    group by user_id,vital ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='moisture' and quarter=3 and values >=60 and values<=90 and user_id = userid group by user_id,vital   ),
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='moisture' and quarter=3 and user_id = userid group by user_id,vital    ),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='moisture' and quarter=3 and values >=60 and values<=90  and user_id = userid       group by user_id,vital,date order by date desc limit 1)	
where Vital='moisture' and quarter=3  and user_id = userid  ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='visceral_fat' and quarter=3 and user_id = userid group by user_id,vital    ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='visceral_fat' and quarter=3 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='visceral_fat' and quarter=1and user_id = userid     group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='visceral_fat' and quarter=3 and values >=60 and values<=90 and  user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='visceral_fat' and quarter=3 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='bmr' and quarter=3 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='bmr' and quarter=3 and values >=60 and values<=90  and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='bmr' and quarter=1and user_id = userid     group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='bmr' and quarter=3 and values >=60 and values<=90 
and user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='bmr' and quarter=3 and user_id = userid ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='bodyage' and quarter=3 and user_id = userid group by user_id,vital    ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='bodyage' and quarter=3 and values >=60 and values<=90 and  user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='bodyage' and quarter=3 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='bodyage' and quarter=3 and values >=60 and values<=90 and user_id = userid     group by user_id,vital,date order by date desc limit 1)	
where Vital='bodyage' and quarter=3 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot" 
				   where vital='heart_rate ' and quarter=3 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"
				  where vital='heart_rate ' and quarter=3 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"
							where vital='heart_rate ' and quarter=3  and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where 
							Vital='heart_rate ' and quarter=3 and values >=60 and values<=90 and user_id = userid      group by user_id,vital,date order by date desc limit 1)	
where Vital='heart_rate ' and quarter=3 and user_id = userid    ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='heart_rate_real_time ' and quarter=3 and user_id = userid group by user_id,vital    ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='heart_rate_real_time ' and quarter=3 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='heart_rate_real_time ' and quarter=3 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='heart_rate_real_time ' and quarter=3 and values >=60 and values<=90 and user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='heart_rate_real_time ' and quarter=3 and user_id = userid     ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='blood_pressure_up ' and quarter=3 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='blood_pressure_up ' and quarter=3 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='blood_pressure_up ' and quarter=3 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='blood_pressure_up ' and quarter=3 and values >=60 and values<=90 and  user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='blood_pressure_up ' and quarter=3 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='blood_pressure_down ' and quarter=3 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='blood_pressure_down ' and quarter=3 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='blood_pressure_down ' and quarter=3 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='blood_pressure_down ' and quarter=3 and values >=60 and values<=90 and user_id = userid       group by user_id,vital,date order by date desc limit 1)	
where Vital='blood_pressure_down ' and quarter=3  and user_id = userid     ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='blood_oxygen ' and quarter=3 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='blood_oxygen ' and quarter=3 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='blood_oxygen ' and quarter=3 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='blood_oxygen ' and quarter=3 and values >=60 and values<=90 and user_id = userid       group by user_id,vital,date order by date desc limit 1)	
where Vital='blood_oxygen ' and quarter=3 and user_id = userid    ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='blood_oxygen_real_time ' and quarter=3 and user_id = userid group by user_id,vital    ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='blood_oxygen_real_time ' and quarter=3 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='blood_oxygen_real_time ' and quarter=3 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='blood_oxygen_real_time ' and quarter=3 and values >=60 and values<=90 and user_id = userid      group by user_id,vital,date order by date desc limit 1)	
where Vital='blood_oxygen_real_time ' and quarter=3 and user_id = userid     ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='ecg' and quarter=3 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='ecg' and quarter=3 and values >=60 and values<=90 and  user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='ecg' and quarter=3 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='ecg' and quarter=3 and values >=60 and values<=90 and user_id = userid      group by user_id,vital,date order by date desc limit 1)	
where Vital='ecg' and quarter=3 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='steps' and quarter=3 and user_id = userid group by user_id,vital    ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='steps' and quarter=3 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='steps' and quarter=3 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='steps' and quarter=3 and values >=60 and values<=90 and user_id = userid       group by user_id,vital,date order by date desc limit 1)	
where Vital='steps' and quarter=3 and user_id = userid ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='spo2' and quarter=3 and user_id = userid group by user_id,vital    ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='spo2' and quarter=3 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='spo2' and quarter=3 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='spo2' and quarter=3 and values >=60 and values<=90 and user_id = userid      group by user_id,vital,date order by date desc limit 1)	
where Vital='spo2' and quarter=3 and user_id = userid     ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='sleep_minutes ' and quarter=3 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='sleep_minutes ' and quarter=3 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='sleep_minutes ' and quarter=3 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='sleep_minutes ' and quarter=3 and values >=60 and values<=90 and user_id = userid        group by user_id,vital,date order by date desc limit 1)	
where Vital='sleep_minutes ' and quarter=3 and user_id = userid ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='sleep_hours ' and quarter=3 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='sleep_hours ' and quarter=3 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='sleep_hours ' and quarter=3 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='sleep_hours ' and quarter=3 and values >=60 and values<=90  and user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='sleep_hours ' and quarter=3 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='deep_sleep ' and quarter=3 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='deep_sleep ' and quarter=3 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='deep_sleep ' and quarter=3 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='deep_sleep ' and quarter=3 and values >=60 and values<=90 and user_id = userid       group by user_id,vital,date order by date desc limit 1)	
where Vital='deep_sleep ' and quarter=3 and user_id = userid    ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='shallow_sleep' and quarter=3 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='shallow_sleep' and quarter=3 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='shallow_sleep' and quarter=3 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='shallow_sleep' and quarter=3 and values >=60 and values<=90 and  user_id = userid      group by user_id,vital,date order by date desc limit 1)	
where Vital='shallow_sleep' and quarter=3 and user_id = userid; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='WHR' and quarter=3 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='WHR' and quarter=3 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='WHR' and quarter=3 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='WHR' and quarter=3 and values >=60 and values<=90 and user_id = userid     group by user_id,vital,date order by date desc limit 1)	
where Vital='WHR' and quarter=3 and user_id = userid    ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='HBA1C' and quarter=3 and user_id = userid group by user_id,vital    ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='HBA1C' and quarter=3 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='HBA1C' and quarter=3  and user_id = userid group by user_id,vital    ),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='HBA1C' and quarter=3 and values >=60 and values<=90 and user_id = userid     group by user_id,vital,date order by date desc limit 1)	
where Vital='HBA1C' and quarter=3 and user_id = userid      ;

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='HDL_Cholesterol' and quarter=3 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='HDL_Cholesterol' and quarter=3 and values >=60 and values<=90 and  user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='HDL_Cholesterol' and quarter=3 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='HDL_Cholesterol' and quarter=3 and values >=60 and values<=90 and user_id = userid       group by user_id,vital,date order by date desc limit 1)	
where Vital='HDL_Cholesterol' and quarter=3 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='LDL_Cholesterol' and quarter=3 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='LDL_Cholesterol' and quarter=3 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='LDL_Cholesterol' and quarter=3 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='LDL_Cholesterol' and quarter=3 and values >=60 and values<=90 and user_id = userid       group by user_id,vital,date order by date desc limit 1)	
where Vital='LDL_Cholesterol' and quarter=3 and user_id = userid     ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='Total_Cholesterol' and quarter=3 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='Total_Cholesterol' and quarter=3 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='Total_Cholesterol' and quarter=3 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='Total_Cholesterol' and quarter=3 and values >=60 and values<=90 and user_id = userid       group by user_id,vital,date order by date desc limit 1)	
where Vital='Total_Cholesterol' and quarter=3 and user_id = userid ; 


update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='Triglycerides' and quarter=3 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='Triglycerides' and quarter=3 and values >=60 and values<=90 and  user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"
							where vital='Triglycerides' and quarter=3
							and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='Triglycerides' and quarter=3 and values >=60 and values<=90 and user_id = userid        group by user_id,vital,date order by date desc limit 1)	
where Vital='Triglycerides' and quarter=3  and user_id = userid    ; 		
update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='sys' and quarter=4  and user_id = userid group by user_id,vital),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='sys' and quarter=4 and user_id = userid   and values >=60 and values<=90 group by user_id ,vital) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='sys' and quarter=4 and  user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='sys' and quarter=4 and  user_id = userid and values >=60 and values<=90   group by user_id,vital,user_id,date order by date desc limit 1)	where Vital='sys' and quarter=4 and user_id=14  ; 
						
update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='dia' and quarter=4 and user_id = userid group by user_id,vital),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='dia' and quarter=4 and values >=60 and values<=90 and  user_id = userid group by user_id,vital   ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='dia' and quarter=4 and user_id = userid group by user_id,vital   ),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='dia' and quarter=4 and values >=60 and values<=90 and user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='dia' and quarter=4 and user_id = userid     ; 
						
update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot" 
				   where vital='pul' and quarter=4 and  user_id = userid group by user_id,vital  ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='pul' and quarter=4 and values >=60 and values<=90 and user_id = userid  group by user_id,vital   ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='pul' and quarter=4 and user_id = userid group by user_id,vital   ),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='pul' and quarter=4 and values >=60 and values<=90 and user_id = userid   group by user_id,vital,date order by date desc limit 1)	
where Vital='pul' and quarter=4 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='body_weight' and quarter=4 and  user_id = userid group by user_id,vital  ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='body_weight' and quarter=4 and values >=60 and values<=90 and user_id = userid  group by user_id,vital   ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='body_weight' and quarter=4 and   user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='body_weight' and quarter=4 and values >=60 and values<=90 and  user_id = userid  group by user_id,vital,date order by date desc limit 1)	
where Vital='body_weight' and quarter=4 and user_id = userid    ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='bmi' and quarter=4 and  user_id = userid group by user_id,vital  ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='bmi' and quarter=4 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='bmi' and quarter=4 and user_id = userid group by user_id,vital    ),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='bmi' and quarter=4 and values >=60 and values<=90  and  user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='bmi' and quarter=4  and user_id = userid     ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='skeleton' and quarter=4 and  user_id = userid group by user_id,vital  ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='skeleton' and quarter=4 and values >=60 and values<=90 and user_id = userid group by user_id,vital   ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='skeleton' and quarter=4 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='skeleton' and quarter=4 and values >=60 and values<=90 and user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='skeleton' and quarter=4 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='fat' and quarter=4 and user_id = userid group by user_id,vital   ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='fat' and quarter=4 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='fat' and quarter=4 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='fat' and quarter=4 and values >=60 and values<=90 and user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='fat' and quarter=4 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='muscle' and quarter=4 and  user_id = userid group by user_id,vital  ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='muscle' and quarter=4 and values >=60 and values<=90 and user_id = userid group by user_id,vital   ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='muscle' and quarter=4 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='muscle' and quarter=4 and values >=60 and values<=90 and user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='muscle' and quarter=4 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='moisture' and quarter=4 and user_id = userid    group by user_id,vital ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='moisture' and quarter=4 and values >=60 and values<=90 and user_id = userid group by user_id,vital   ),
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='moisture' and quarter=4 and user_id = userid group by user_id,vital    ),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='moisture' and quarter=4 and values >=60 and values<=90  and user_id = userid       group by user_id,vital,date order by date desc limit 1)	
where Vital='moisture' and quarter=4  and user_id = userid  ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='visceral_fat' and quarter=4 and user_id = userid group by user_id,vital    ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='visceral_fat' and quarter=4 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='visceral_fat' and quarter=1and user_id = userid     group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='visceral_fat' and quarter=4 and values >=60 and values<=90 and  user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='visceral_fat' and quarter=4 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='bmr' and quarter=4 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='bmr' and quarter=4 and values >=60 and values<=90  and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='bmr' and quarter=1and user_id = userid     group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='bmr' and quarter=4 and values >=60 and values<=90 
and user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='bmr' and quarter=4 and user_id = userid ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='bodyage' and quarter=4 and user_id = userid group by user_id,vital    ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='bodyage' and quarter=4 and values >=60 and values<=90 and  user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='bodyage' and quarter=4 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='bodyage' and quarter=4 and values >=60 and values<=90 and user_id = userid     group by user_id,vital,date order by date desc limit 1)	
where Vital='bodyage' and quarter=4 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot" 
				   where vital='heart_rate ' and quarter=4 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"
				  where vital='heart_rate ' and quarter=4 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"
							where vital='heart_rate ' and quarter=4  and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where 
							Vital='heart_rate ' and quarter=4 and values >=60 and values<=90 and user_id = userid      group by user_id,vital,date order by date desc limit 1)	
where Vital='heart_rate ' and quarter=4 and user_id = userid    ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='heart_rate_real_time ' and quarter=4 and user_id = userid group by user_id,vital    ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='heart_rate_real_time ' and quarter=4 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='heart_rate_real_time ' and quarter=4 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='heart_rate_real_time ' and quarter=4 and values >=60 and values<=90 and user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='heart_rate_real_time ' and quarter=4 and user_id = userid     ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='blood_pressure_up ' and quarter=4 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='blood_pressure_up ' and quarter=4 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='blood_pressure_up ' and quarter=4 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='blood_pressure_up ' and quarter=4 and values >=60 and values<=90 and  user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='blood_pressure_up ' and quarter=4 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='blood_pressure_down ' and quarter=4 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='blood_pressure_down ' and quarter=4 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='blood_pressure_down ' and quarter=4 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='blood_pressure_down ' and quarter=4 and values >=60 and values<=90 and user_id = userid       group by user_id,vital,date order by date desc limit 1)	
where Vital='blood_pressure_down ' and quarter=4  and user_id = userid     ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='blood_oxygen ' and quarter=4 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='blood_oxygen ' and quarter=4 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='blood_oxygen ' and quarter=4 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='blood_oxygen ' and quarter=4 and values >=60 and values<=90 and user_id = userid       group by user_id,vital,date order by date desc limit 1)	
where Vital='blood_oxygen ' and quarter=4 and user_id = userid    ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='blood_oxygen_real_time ' and quarter=4 and user_id = userid group by user_id,vital    ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='blood_oxygen_real_time ' and quarter=4 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='blood_oxygen_real_time ' and quarter=4 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='blood_oxygen_real_time ' and quarter=4 and values >=60 and values<=90 and user_id = userid      group by user_id,vital,date order by date desc limit 1)	
where Vital='blood_oxygen_real_time ' and quarter=4 and user_id = userid     ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='ecg' and quarter=4 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='ecg' and quarter=4 and values >=60 and values<=90 and  user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='ecg' and quarter=4 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='ecg' and quarter=4 and values >=60 and values<=90 and user_id = userid      group by user_id,vital,date order by date desc limit 1)	
where Vital='ecg' and quarter=4 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='steps' and quarter=4 and user_id = userid group by user_id,vital    ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='steps' and quarter=4 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='steps' and quarter=4 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='steps' and quarter=4 and values >=60 and values<=90 and user_id = userid       group by user_id,vital,date order by date desc limit 1)	
where Vital='steps' and quarter=4 and user_id = userid ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='spo2' and quarter=4 and user_id = userid group by user_id,vital    ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='spo2' and quarter=4 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='spo2' and quarter=4 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='spo2' and quarter=4 and values >=60 and values<=90 and user_id = userid      group by user_id,vital,date order by date desc limit 1)	
where Vital='spo2' and quarter=4 and user_id = userid     ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='sleep_minutes ' and quarter=4 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='sleep_minutes ' and quarter=4 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='sleep_minutes ' and quarter=4 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='sleep_minutes ' and quarter=4 and values >=60 and values<=90 and user_id = userid        group by user_id,vital,date order by date desc limit 1)	
where Vital='sleep_minutes ' and quarter=4 and user_id = userid ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='sleep_hours ' and quarter=4 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='sleep_hours ' and quarter=4 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='sleep_hours ' and quarter=4 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='sleep_hours ' and quarter=4 and values >=60 and values<=90  and user_id = userid group by user_id,vital,date order by date desc limit 1)	
where Vital='sleep_hours ' and quarter=4 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='deep_sleep ' and quarter=4 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='deep_sleep ' and quarter=4 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='deep_sleep ' and quarter=4 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='deep_sleep ' and quarter=4 and values >=60 and values<=90 and user_id = userid       group by user_id,vital,date order by date desc limit 1)	
where Vital='deep_sleep ' and quarter=4 and user_id = userid    ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='shallow_sleep' and quarter=4 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='shallow_sleep' and quarter=4 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='shallow_sleep' and quarter=4 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='shallow_sleep' and quarter=4 and values >=60 and values<=90 and  user_id = userid      group by user_id,vital,date order by date desc limit 1)	
where Vital='shallow_sleep' and quarter=4 and user_id = userid; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='WHR' and quarter=4 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='WHR' and quarter=4 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='WHR' and quarter=4 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='WHR' and quarter=4 and values >=60 and values<=90 and user_id = userid     group by user_id,vital,date order by date desc limit 1)	
where Vital='WHR' and quarter=4 and user_id = userid    ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='HBA1C' and quarter=4 and user_id = userid group by user_id,vital    ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='HBA1C' and quarter=4 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='HBA1C' and quarter=4  and user_id = userid group by user_id,vital    ),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='HBA1C' and quarter=4 and values >=60 and values<=90 and user_id = userid     group by user_id,vital,date order by date desc limit 1)	
where Vital='HBA1C' and quarter=4 and user_id = userid      ;

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='HDL_Cholesterol' and quarter=4 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='HDL_Cholesterol' and quarter=4 and values >=60 and values<=90 and  user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='HDL_Cholesterol' and quarter=4 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='HDL_Cholesterol' and quarter=4 and values >=60 and values<=90 and user_id = userid       group by user_id,vital,date order by date desc limit 1)	
where Vital='HDL_Cholesterol' and quarter=4 and user_id = userid      ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='LDL_Cholesterol' and quarter=4 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='LDL_Cholesterol' and quarter=4 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='LDL_Cholesterol' and quarter=4 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='LDL_Cholesterol' and quarter=4 and values >=60 and values<=90 and user_id = userid       group by user_id,vital,date order by date desc limit 1)	
where Vital='LDL_Cholesterol' and quarter=4 and user_id = userid     ; 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='Total_Cholesterol' and quarter=4 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='Total_Cholesterol' and quarter=4 and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='Total_Cholesterol' and quarter=4 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='Total_Cholesterol' and quarter=4 and values >=60 and values<=90 and user_id = userid       group by user_id,vital,date order by date desc limit 1)	
where Vital='Total_Cholesterol' and quarter=4 and user_id = userid ; 


update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='Triglycerides' and quarter=4 and user_id = userid group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='Triglycerides' and quarter=4 and values >=60 and values<=90 and  user_id = userid group by user_id,vital    ) ,
Initial = (SELECT ROUND(avg(values))  FROM public."Quaterly_Pivot"  where vital='Triglycerides' and quarter=4 and user_id = userid group by user_id,vital),
achieved= (select ROUND(avg(values))  FROM public."Quaterly_Pivot" where Vital='Triglycerides' and quarter=4 and values >=60 and values<=90 and user_id = userid        group by user_id,vital,date order by date desc limit 1)	
where Vital='Triglycerides' and quarter=4  and user_id = userid    ; 		
loop1 :=loop1+1;
end LOOP;
END;
drop table final_quarter;
CREATE TABLE final_quarter AS
select vital,quarter,year,user_id,initial,target,achieved,performance,Normal_Count,total_count,target_new from public."Quaterly_Pivot" 
group by vital,quarter,year,user_id,initial,target,achieved,performance,Normal_Count,total_count,target_new;


						
end;
$$ LANGUAGE plpgsql;
						
						




