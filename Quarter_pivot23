--select qjobs72()
--select * from final_quarter where user_id = 726
--select * from final_quarter where user_id = 682
--delete   from public."Quaterly_Final" where user_id = 670 and quarter = 
--select * from public."Quaterly_Pivot" where user_id = 524 and quarter =3
--select * from public."Quaterly_Pivot" where user_id = 734
--select * from users where email='test900@gmail.com'
--update public."Quaterly_Pivot" set initial =0,target =0 ,achieved = 0,normal_count =0 ,total_count =0
CREATE OR REPLACE FUNCTION public.qjobs72(
	)
    RETURNS void
    LANGUAGE 'plpgsql'

    COST 100
    VOLATILE 
AS $BODY$
   DECLARE count1 integer;
DECLARE userid integer;
DECLARE loop1 integer:=1;
begin
drop table ss3;
create table ss3 (id int GENERATED ALWAYS AS IDENTITY,user_id int);
insert into ss3 (user_id)
select distinct user_id  from public."Quaterly_Final" ;
select count(*) into count1 from ss3;
update public."Quaterly_Pivot" set initial =0,target =0 ,achieved = 0,normal_count =0 ,total_count =0;
while (loop1<=(count1)) LOOP
select user_id into userid from ss3 where id=loop1;
			   

  update public."Quaterly_Pivot" 
set total_count = (SELECT count(sys) FROM public."Quaterly_Final"  where  quarter=1  and user_id = userid and sys is not null and sys<>0   group by user_id),
Normal_Count = (SELECT count(sys) FROM public."Quaterly_Final"  where  quarter=1 and user_id = userid and sys is not null and sys<>0   and sys >=60 and sys<=90 group by user_id ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='sys' and quarter=1 and  user_id = userid and values is not null and values<>0 
								 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='sys' 
							and quarter=1 and  user_id = userid and  values is not null and values<>0 
							group by user_id,vital,user_id,date,values order by date desc limit 1)	
						where Vital='sys' and quarter=1 and user_id=userid ;
update public."Quaterly_Pivot" 
set total_count = (SELECT count(dia) FROM public."Quaterly_Final"  where  quarter=1  and user_id = userid and dia is not null and dia<>0   group by user_id),
Normal_Count = (SELECT count(dia) FROM public."Quaterly_Final"  where  quarter=1 and user_id = userid and dia is not null and dia<>0   and dia >=60 and dia<=90 group by user_id ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='dia' and quarter=1 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='dia' and quarter=1 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='dia' and quarter=1 and user_id=userid ;				


update public."Quaterly_Pivot" 
set total_count = (SELECT count(body_weight) FROM public."Quaterly_Final"  where  quarter=1  and user_id = userid and body_weight is not null and body_weight<>0   group by user_id),
Normal_Count = (SELECT count(body_weight) FROM public."Quaterly_Final"  where  quarter=1 and user_id = userid and body_weight is not null and body_weight<>0   and body_weight >=60 and body_weight<=90 group by user_id ), 
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='body_weight' and quarter=1 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='body_weight' and quarter=1 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='body_weight' and quarter=1 and user_id=userid ;				 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='bmi' and quarter=1 and  user_id = userid and values is not null and values<>0   group by user_id,vital  ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='bmi' and quarter=1 and values is not null and values<>0  and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='bmi' and quarter=1 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='bmi' and quarter=1 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='bmi' and quarter=1 and user_id=userid ;				 



update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='skeleton' and quarter=1 and  user_id = userid and values is not null and values<>0   group by user_id,vital  ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='skeleton' and quarter=1 and values is not null and values<>0  and values >=60 and values<=90 and user_id = userid group by user_id,vital   ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='skeleton' and quarter=1 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='skelton' and quarter=1 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='skelton' and quarter=1 and user_id=userid ;				 


update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='fat' and quarter=1 and user_id = userid and values is not null and values<>0   group by user_id,vital   ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='fat' and quarter=1 and values is not null and values<>0   and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='fat' and quarter=1 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='fat' and quarter=1 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='fat' and quarter=1 and user_id=userid ;				 


update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='muscle' and quarter=1 and  user_id = userid and values is not null and values<>0   group by user_id,vital  ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='muscle' and quarter=1  and values is not null and values<>0  and values >=60 and values<=90 and user_id = userid group by user_id,vital   ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='muscle' and quarter=1 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='muscle' and quarter=1 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='muscle' and quarter=1 and user_id=userid ;				 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='moisture' and quarter=1 and user_id = userid and values is not null and values<>0     group by user_id,vital ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='moisture' and quarter=1 and values is not null and values<>0  and values >=60 and values<=90 and user_id = userid group by user_id,vital   ),
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='moisture' and quarter=1 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='moisture' and quarter=1 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='moisture' and quarter=1 and user_id=userid ;

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='visceral_fat' and quarter=1 and user_id = userid and values is not null and values<>0  group by user_id,vital    ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='visceral_fat' and quarter=1 and values is not null and values<>0  and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='visceral_fat' and quarter=1 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='visceral_fat' and quarter=1 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='visceral_fat' and quarter=1 and user_id=userid ;				 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='bmr' and quarter=1 and user_id = userid and values is not null and values<>0   group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='bmr' and quarter=1 and values is not null and values<>0   and values >=60 and values<=90  and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='bmr' and quarter=1 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='bmr' and quarter=1 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='bmr' and quarter=1 and user_id=userid ;				 


update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='bodyage' and quarter=1 and user_id = userid and values is not null and values<>0   group by user_id,vital    ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='bodyage' and quarter=1 and values is not null and values<>0 and  values >=60 and values<=90 and  user_id = userid group by user_id,vital    ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='bodyage' and quarter=1 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='bodyage' and quarter=1 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='bodyage' and quarter=1 and user_id=userid ;				 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(heart_rate) FROM public."Quaterly_Final"  where  quarter=1  and user_id = userid and heart_rate is not null and heart_rate<>0   group by user_id),
Normal_Count = (SELECT count(heart_rate) FROM public."Quaterly_Final"  where  quarter=1 and user_id = userid and heart_rate is not null and heart_rate<>0   and heart_rate >=60 and heart_rate<=90 group by user_id ), 
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='heart_rate' and quarter=1 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='heart_rate' and quarter=1 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='heart_rate' and quarter=1 and user_id=userid ;				 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='ecg' and quarter=1 and user_id = userid and values is not null and values<>0   group by user_id,vital    ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='ecg' and quarter=1 and values is not null and values<>0   and values >=60 and values<=90 and  user_id = userid group by user_id,vital    ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='ecg' and quarter=1 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='ecg' and quarter=1 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='ecg' and quarter=1 and user_id=userid ;				 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(steps) FROM public."Quaterly_Final"  where  quarter=1  and user_id = userid and steps is not null and steps<>0   group by user_id),
Normal_Count = (SELECT count(steps) FROM public."Quaterly_Final"  where  quarter=1 and user_id = userid and steps is not null and steps<>0   and steps >=60 and steps<=90 group by user_id ), 
Initial = ( select sum(steps) from public."Quaterly_Final" where date(date) = 
		   (select min(date(date)) from public."Quaterly_Final" where quarter =1 and user_id = userid and steps is not null)	
					   and quarter =1 and user_id = userid and steps is not null),														 
achieved= (select sum(steps) from public."Quaterly_Final" where date(date) =
		   (select max(date(date)) from public."Quaterly_Final" where quarter =1 and user_id = userid and steps is not null)
					   and quarter =1 and user_id = userid and steps is not null) where
			user_id = userid and quarter =1 and vital = 'steps';

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='spo2' and quarter=1 and user_id = userid and values is not null and values<>0   group by user_id,vital    ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='spo2' and quarter=1 and values is not null and values<>0   and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='spo2' and quarter=1 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='spo2' and quarter=1 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='spo2' and quarter=1 and user_id=userid ;				 

 update public."Quaterly_Pivot" 
set total_count = (SELECT count(sys) FROM public."Quaterly_Final"  where  quarter=2  and user_id = userid and sys is not null and sys<>0   group by user_id),
Normal_Count = (SELECT count(sys) FROM public."Quaterly_Final"  where  quarter=2 and user_id = userid and sys is not null and sys<>0   and sys >=60 and sys<=90 group by user_id ), 
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='sys' and quarter=2 and  user_id = userid and values is not null and values<>0 
								 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='sys' 
							and quarter=2 and  user_id = userid and  values is not null and values<>0 
							group by user_id,vital,user_id,date,values order by date desc limit 1)	
						where Vital='sys' and quarter=2 and user_id=userid ;
update public."Quaterly_Pivot" 
set total_count = (SELECT count(dia) FROM public."Quaterly_Final"  where  quarter=2  and user_id = userid and dia is not null and dia<>0   group by user_id),
Normal_Count = (SELECT count(dia) FROM public."Quaterly_Final"  where  quarter=2 and user_id = userid and dia is not null and dia<>0   and dia >=60 and dia<=90 group by user_id ), 
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='dia' and quarter=2 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='dia' and quarter=2 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='dia' and quarter=2 and user_id=userid ;				


update public."Quaterly_Pivot" 
set total_count = (SELECT count(body_weight) FROM public."Quaterly_Final"  where  quarter=2  and user_id = userid and body_weight is not null and body_weight<>0   group by user_id),
Normal_Count = (SELECT count(body_weight) FROM public."Quaterly_Final"  where  quarter=2 and user_id = userid and body_weight is not null and body_weight<>0   and body_weight >=60 and body_weight<=90 group by user_id ), 
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='body_weight' and quarter=2 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='body_weight' and quarter=2 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='body_weight' and quarter=2 and user_id=userid ;				 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='bmi' and quarter=2 and  user_id = userid and values is not null and values<>0   group by user_id,vital  ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='bmi' and quarter=2 and values is not null and values<>0  and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='bmi' and quarter=2 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='bmi' and quarter=2 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='bmi' and quarter=2 and user_id=userid ;				 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='skeleton' and quarter=2 and  user_id = userid and values is not null and values<>0   group by user_id,vital  ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='skeleton' and quarter=2 and values is not null and values<>0  and values >=60 and values<=90 and user_id = userid group by user_id,vital   ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='skeleton' and quarter=2
		   and  user_id = 477 and values is not null and values<>0
		   group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='skelton' and quarter=2 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='skelton' and quarter=2 and user_id=userid ;				 


update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='fat' and quarter=2 and user_id = userid and values is not null and values<>0   group by user_id,vital   ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='fat' and quarter=2 and values is not null and values<>0   and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='fat' and quarter=2 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='fat' and quarter=2 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='fat' and quarter=2 and user_id=userid ;				 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='muscle' and quarter=2 and  user_id = userid and values is not null and values<>0   group by user_id,vital  ),
  Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='muscle' and quarter=2  and values is not null and values<>0  and values >=60 and values<=90 and user_id = userid group by user_id,vital   ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='muscle' and quarter=2 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='muscle' and quarter=2 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='muscle' and quarter=2 and user_id=userid ;				 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='moisture' and quarter=2 and user_id = userid and values is not null and values<>0     group by user_id,vital ),
Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='moisture' and quarter=2 and values is not null and values<>0  and values >=60 and values<=90 and user_id = userid group by user_id,vital   ),
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='moisture' and quarter=2 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='moisture' and quarter=2 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='moisture' and quarter=2 and user_id=userid ;

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='visceral_fat' and quarter=2 and user_id = userid and values is not null and values<>0  group by user_id,vital    ),
Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='visceral_fat' and quarter=2 and values is not null and values<>0  and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='visceral_fat' and quarter=2 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='visceral_fat' and quarter=2 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='visceral_fat' and quarter=2 and user_id=userid ;				 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='bmr' and quarter=2 and user_id = userid and values is not null and values<>0   group by user_id,vital    ),
Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='bmr' and quarter=2 and values is not null and values<>0   and values >=60 and values<=90  and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='bmr' and quarter=2 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='bmr' and quarter=2 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='bmr' and quarter=2 and user_id=userid ;				 


update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='bodyage' and quarter=2 and user_id = userid and values is not null and values<>0   group by user_id,vital    ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='bodyage' and quarter=2 and values is not null and values<>0 and  values >=60 and values<=90 and  user_id = userid group by user_id,vital    ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='bodyage' and quarter=2 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='bodyage' and quarter=2 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='bodyage' and quarter=2 and user_id=userid ;				 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(heart_rate) FROM public."Quaterly_Final"  where  quarter=2  and user_id = userid and heart_rate is not null and heart_rate<>0   group by user_id),
Normal_Count = (SELECT count(heart_rate) FROM public."Quaterly_Final"  where  quarter=2 and user_id = userid and heart_rate is not null and heart_rate<>0   and heart_rate >=60 and heart_rate<=90 group by user_id ), 
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='heart_rate' and quarter=2 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='heart_rate' and quarter=2 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='heart_rate' and quarter=2 and user_id=userid ;				 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='ecg' and quarter=2 and user_id = userid and values is not null and values<>0   group by user_id,vital    ),
Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='ecg' and quarter=2 and values is not null and values<>0   and values >=60 and values<=90 and  user_id = userid group by user_id,vital    ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='ecg' and quarter=2 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='ecg' and quarter=2 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='ecg' and quarter=2 and user_id=userid ;				 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(steps) FROM public."Quaterly_Final"  where  quarter=2  and user_id = userid and steps is not null and steps<>0   group by user_id),
Normal_Count = (SELECT count(steps) FROM public."Quaterly_Final"  where  quarter=2 and user_id = userid and steps is not null and steps<>0   and steps >=60 and steps<=90 group by user_id ), 
Initial = ( select sum(steps) from public."Quaterly_Final" where date(date) = 
		   (select min(date(date)) from public."Quaterly_Final" where quarter =2 and user_id = userid and steps is not null)	
					   and quarter =2 and user_id = userid and steps is not null),														 
achieved= (select sum(steps) from public."Quaterly_Final" where date(date) =
		   (select max(date(date)) from public."Quaterly_Final" where quarter =2 and user_id = userid and steps is not null)
					   and quarter =2 and user_id = userid and steps is not null) where
			user_id = userid and quarter =2 and vital = 'steps';

			
			update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='spo2' and quarter=2 and user_id = userid and values is not null and values<>0   group by user_id,vital    ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='spo2' and quarter=2 and values is not null and values<>0   and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='spo2' and quarter=2 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='spo2' and quarter=2 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='spo2' and quarter=2 and user_id=userid ;	

update public."Quaterly_Pivot" 
set total_count = (SELECT count(sys) FROM public."Quaterly_Final"  where  quarter=3  and user_id = userid and sys is not null and sys<>0   group by user_id),
Normal_Count = (SELECT count(sys) FROM public."Quaterly_Final"  where  quarter=3 and user_id = userid and sys is not null and sys<>0   and sys >=60 and sys<=90 group by user_id ), 
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='sys' and quarter=3 and  user_id = userid and values is not null and values<>0 
								 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='sys' 
							and quarter=3 and  user_id = userid and  values is not null and values<>0 
							group by user_id,vital,user_id,date,values order by date desc limit 1)	
						where Vital='sys' and quarter=3 and user_id=userid ;

						update public."Quaterly_Pivot" 
set total_count = (SELECT count(dia) FROM public."Quaterly_Final"  where  quarter=3  and user_id = userid and dia is not null and dia<>0   group by user_id),
Normal_Count = (SELECT count(dia) FROM public."Quaterly_Final"  where  quarter=3 and user_id = userid and dia is not null and dia<>0   and dia >=60 and dia<=90 group by user_id ), 
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='dia' and quarter=3 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='dia' and quarter=3 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='dia' and quarter=3 and user_id=userid ;				

update public."Quaterly_Pivot" 
set total_count = (SELECT count(body_weight) FROM public."Quaterly_Final"  where  quarter=3  and user_id = userid and body_weight is not null and body_weight<>0   group by user_id),
Normal_Count = (SELECT count(body_weight) FROM public."Quaterly_Final"  where  quarter=3 and user_id = userid and body_weight is not null and body_weight<>0   and body_weight >=60 and body_weight<=90 group by user_id ), 
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='body_weight' and quarter=3 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='body_weight' and quarter=3 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='body_weight' and quarter=3 and user_id=userid ;				 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='bmi' and quarter=3 and  user_id = userid and values is not null and values<>0   group by user_id,vital  ),
Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='bmi' and quarter=3 and values is not null and values<>0  and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='bmi' and quarter=3 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='bmi' and quarter=3 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='bmi' and quarter=3 and user_id=userid ;				 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='skeleton' and quarter=3 and  user_id = userid and values is not null and values<>0   group by user_id,vital  ),
Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='skeleton' and quarter=3 and values is not null and values<>0  and values >=60 and values<=90 and user_id = userid group by user_id,vital   ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='skeleton' and quarter=3 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='skelton' and quarter=3 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='skelton' and quarter=3 and user_id=userid ;				 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='fat' and quarter=3 and user_id = userid and values is not null and values<>0   group by user_id,vital   ),
 normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='fat' and quarter=3 and values is not null and values<>0   and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='fat' and quarter=3 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='fat' and quarter=3 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='fat' and quarter=3 and user_id=userid ;				 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='muscle' and quarter=3 and  user_id = userid and values is not null and values<>0   group by user_id,vital  ),
Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='muscle' and quarter=3  and values is not null and values<>0  and values >=60 and values<=90 and user_id = userid group by user_id,vital   ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='muscle' and quarter=3 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='muscle' and quarter=3 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='muscle' and quarter=3 and user_id=userid ;				 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='moisture' and quarter=3 and user_id = userid and values is not null and values<>0     group by user_id,vital ),
Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='moisture' and quarter=3 and values is not null and values<>0  and values >=60 and values<=90 and user_id = userid group by user_id,vital   ),
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='moisture' and quarter=3 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='moisture' and quarter=3 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='moisture' and quarter=3 and user_id=userid ;

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='visceral_fat' and quarter=3 and user_id = userid and values is not null and values<>0  group by user_id,vital    ),
Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='visceral_fat' and quarter=3 and values is not null and values<>0  and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='visceral_fat' and quarter=3 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='visceral_fat' and quarter=3 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='visceral_fat' and quarter=3 and user_id=userid ;				 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='bmr' and quarter=3 and user_id = userid and values is not null and values<>0   group by user_id,vital    ),
Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='bmr' and quarter=3 and values is not null and values<>0   and values >=60 and values<=90  and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='bmr' and quarter=3 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='bmr' and quarter=3 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='bmr' and quarter=3 and user_id=userid ;				 


update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='bodyage' and quarter=3 and user_id = userid and values is not null and values<>0   group by user_id,vital    ),
Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='bodyage' and quarter=3 and values is not null and values<>0 and  values >=60 and values<=90 and  user_id = userid group by user_id,vital    ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='bodyage' and quarter=3 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='bodyage' and quarter=3 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='bodyage' and quarter=3 and user_id=userid ;				 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(heart_rate) FROM public."Quaterly_Final"  where  quarter=3  and user_id = userid and heart_rate is not null and heart_rate<>0   group by user_id),
Normal_Count = (SELECT count(heart_rate) FROM public."Quaterly_Final"  where  quarter=3 and user_id = userid and heart_rate is not null and heart_rate<>0   and heart_rate >=60 and heart_rate<=90 group by user_id ), 
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='heart_rate' and quarter=3 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='heart_rate' and quarter=3 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='heart_rate' and quarter=3 and user_id=userid ;				 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='ecg' and quarter=3 and user_id = userid and values is not null and values<>0   group by user_id,vital    ),
Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='ecg' and quarter=3 and values is not null and values<>0   and values >=60 and values<=90 and  user_id = userid group by user_id,vital    ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='ecg' and quarter=3 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='ecg' and quarter=3 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='ecg' and quarter=3 and user_id=userid ;
update public."Quaterly_Pivot" 
set total_count = (SELECT count(steps) FROM public."Quaterly_Final"  where  quarter=3  and user_id = userid and steps is not null and steps<>0   group by user_id),
Normal_Count = (SELECT count(steps) FROM public."Quaterly_Final"  where  quarter=3 and user_id = userid and steps is not null and steps<>0   and steps >=60 and steps<=90 group by user_id ), 
Initial = ( select sum(steps) from public."Quaterly_Final" where date(date) = 
		   (select min(date(date)) from public."Quaterly_Final" where quarter =3 and user_id = userid and steps is not null)	
					   and quarter =3 and user_id = userid and steps is not null),														 
achieved= (select sum(steps) from public."Quaterly_Final" where date(date) =
		   (select max(date(date)) from public."Quaterly_Final" where quarter =3 and user_id = userid and steps is not null )
					   and quarter =3 and user_id = userid and steps is not null) where
			user_id = userid and quarter =3 and vital = 'steps';		 
update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='spo2' and quarter=3 and user_id = userid and values is not null and values<>0   group by user_id,vital    ),
Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='spo2' and quarter=3 and values is not null and values<>0   and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='spo2' and quarter=3 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='spo2' and quarter=3 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='spo2' and quarter=3 and user_id=userid ;				 
 
update public."Quaterly_Pivot" 
set total_count = (SELECT count(sys) FROM public."Quaterly_Final"  where  quarter=4  and user_id = userid and sys is not null and sys<>0   group by user_id),
Normal_Count = (SELECT count(sys) FROM public."Quaterly_Final"  where  quarter=4 and user_id = userid and sys is not null and sys<>0   and sys >=60 and sys<=90 group by user_id ), 
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='sys' and quarter=4 and  user_id = userid and values is not null and values<>0 
								 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='sys' 
							and quarter=4 and  user_id = userid and  values is not null and values<>0 
							group by user_id,vital,user_id,date,values order by date desc limit 1)	
						where Vital='sys' and quarter=4 and user_id=userid ;

						update public."Quaterly_Pivot" 
set total_count = (SELECT count(dia) FROM public."Quaterly_Final"  where  quarter=4  and user_id = userid and dia is not null and dia<>0   group by user_id),
Normal_Count = (SELECT count(dia) FROM public."Quaterly_Final"  where  quarter=4 and user_id = userid and dia is not null and dia<>0   and dia >=60 and dia<=90 group by user_id ), 
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='dia' and quarter=4 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='dia' and quarter=4 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='dia' and quarter=4 and user_id=userid ;				

update public."Quaterly_Pivot" 
set total_count = (SELECT count(body_weight) FROM public."Quaterly_Final"  where  quarter=4  and user_id = userid and body_weight is not null and body_weight<>0   group by user_id),
Normal_Count = (SELECT count(body_weight) FROM public."Quaterly_Final"  where  quarter=4 and user_id = userid and body_weight is not null and body_weight<>0   and body_weight >=60 and body_weight<=90 group by user_id ), 
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='body_weight' and quarter=4 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='body_weight' and quarter=4 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='body_weight' and quarter=4 and user_id=userid ;				 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='bmi' and quarter=4 and  user_id = userid and values is not null and values<>0   group by user_id,vital  ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='bmi' and quarter=4 and values is not null and values<>0  and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='bmi' and quarter=4 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='bmi' and quarter=4 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='bmi' and quarter=4 and user_id=userid ;				 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='skeleton' and quarter=4 and  user_id = userid and values is not null and values<>0   group by user_id,vital  ),
Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='skeleton' and quarter=4 and values is not null and values<>0  and values >=60 and values<=90 and user_id = userid group by user_id,vital   ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='skeleton' and quarter=4 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='skelton' and quarter=4 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='skelton' and quarter=4 and user_id=userid ;				 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='fat' and quarter=4 and user_id = userid and values is not null and values<>0   group by user_id,vital   ),
Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='fat' and quarter=4 and values is not null and values<>0   and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='fat' and quarter=4 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='fat' and quarter=4 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='fat' and quarter=4 and user_id=userid ;				 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='muscle' and quarter=4 and  user_id = userid and values is not null and values<>0   group by user_id,vital  ),
Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='muscle' and quarter=4  and values is not null and values<>0  and values >=60 and values<=90 and user_id = userid group by user_id,vital   ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='muscle' and quarter=4 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='muscle' and quarter=4 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='muscle' and quarter=4 and user_id=userid ;				 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='moisture' and quarter=4 and user_id = userid and values is not null and values<>0     group by user_id,vital ),
Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='moisture' and quarter=4 and values is not null and values<>0  and values >=60 and values<=90 and user_id = userid group by user_id,vital   ),
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='moisture' and quarter=4 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='moisture' and quarter=4 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='moisture' and quarter=4 and user_id=userid ;

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='visceral_fat' and quarter=4 and user_id = userid and values is not null and values<>0  group by user_id,vital    ),
Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='visceral_fat' and quarter=4 and values is not null and values<>0  and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='visceral_fat' and quarter=4 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='visceral_fat' and quarter=4 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='visceral_fat' and quarter=4 and user_id=userid ;				 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='bmr' and quarter=4 and user_id = userid and values is not null and values<>0   group by user_id,vital    ),
Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='bmr' and quarter=4 and values is not null and values<>0   and values >=60 and values<=90  and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='bmr' and quarter=4 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='bmr' and quarter=4 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='bmr' and quarter=4 and user_id=userid ;				 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='bodyage' and quarter=4 and user_id = userid and values is not null and values<>0   group by user_id,vital    ),
Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='bodyage' and quarter=4 and values is not null and values<>0 and  values >=60 and values<=90 and  user_id = userid group by user_id,vital    ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='bodyage' and quarter=4 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='bodyage' and quarter=4 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='bodyage' and quarter=4 and user_id=userid ;				 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(heart_rate) FROM public."Quaterly_Final"  where  quarter=4  and user_id = userid and heart_rate is not null and heart_rate<>0   group by user_id),
Normal_Count = (SELECT count(heart_rate) FROM public."Quaterly_Final"  where  quarter=4 and user_id = userid and heart_rate is not null and heart_rate<>0   and heart_rate >=60 and heart_rate<=90 group by user_id ), 
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='heart_rate' and quarter=4 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='heart_rate' and quarter=4 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='heart_rate' and quarter=4 and user_id=userid ;				 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='ecg' and quarter=4 and user_id = userid and values is not null and values<>0   group by user_id,vital    ),
Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='ecg' and quarter=4 and values is not null and values<>0   and values >=60 and values<=90 and  user_id = userid group by user_id,vital    ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='ecg' and quarter=4 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='ecg' and quarter=4 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='ecg' and quarter=4 and user_id=userid ;				 

update public."Quaterly_Pivot" 
set total_count = (SELECT count(values) FROM public."Quaterly_Pivot"  where vital='spo2' and quarter=4 and user_id = userid and values is not null and values<>0   group by user_id,vital    ),
 Normal_Count = (SELECT count(Normal_Count) FROM public."Quaterly_Pivot"  where vital='spo2' and quarter=4 and values is not null and values<>0   and values >=60 and values<=90 and user_id = userid group by user_id,vital    ) ,
Initial = (SELECT values  FROM public."Quaterly_Pivot"  where vital='spo2' and quarter=4 and  user_id = userid and values is not null and values<>0 group by user_id,vital,values,date order by date asc limit 1),
achieved= (select values  FROM public."Quaterly_Pivot" where Vital='spo2' and quarter=4 and  user_id = userid and  values is not null and values<>0 group by user_id,vital,user_id,date,values order by date desc limit 1)	where Vital='spo2' and quarter=4 and user_id=userid ;				 
	
update public."Quaterly_Pivot" 
set total_count = (SELECT count(steps) FROM public."Quaterly_Final"  where  quarter= 4  and user_id = userid and steps is not null 
and steps<>0   group by user_id),
Normal_Count = (SELECT count(steps) FROM public."Quaterly_Final"  where  quarter= 4 and user_id = userid and steps is not null and steps<>0 
  and steps >=60 and steps<=90 group by user_id ), 
Initial = ( select sum(steps) from public."Quaterly_Final" where date(date) = 
		   (select min(date(date)) from public."Quaterly_Final" where quarter = 4 and user_id = userid and steps is not null)	
					   and quarter = 4 and user_id = userid and steps is not null),														 
achieved= (select sum(steps) from public."Quaterly_Final" where date(date) =
		   (select max(date(date)) from public."Quaterly_Final" where quarter = 4 and user_id = userid and steps is not null)
					   and quarter = 4 and user_id = userid and steps is not null) where
			user_id = userid and quarter = 4 and vital = 'steps';													 
										 
loop1 :=loop1+1;
end LOOP;
perform initialreport();
perform initialreport5();
perform Qjobs3();
perform Qperformance();

																			  
 end;
			   $BODY$;

ALTER FUNCTION public.qjobs72()
    OWNER TO postgres;